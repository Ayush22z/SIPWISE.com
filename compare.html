<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Compare Mutual Funds - SIPWISE</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>ðŸ“Š Compare Mutual Fund Returns</h1>
    <p style="color: #666; font-size: 0.95rem;">Select two funds below to see how their SIP returns stack up side-by-side.</p>

    <!-- Dropdowns -->
    <label for="fund1">Fund 1:</label>
    <select id="fund1"></select>

    <label for="fund2">Fund 2:</label>
    <select id="fund2"></select>

    <label for="sipAmount">Monthly SIP (â‚¹):</label>
    <input type="number" id="sipAmount" value="500">

    <label for="years">Duration (Years):</label>
    <input type="number" id="years" value="5">

    <button onclick="compareFunds()">Compare Now</button>

    <canvas id="compareChart"></canvas>

    <div id="compareResult" style="margin-top: 15px;"></div>
  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Fund Data + Logic -->
  <script>
    // âœ… Step 1: Real Fund Data (name => CAGR)
    const fundData = {
      "Nippon India Small Cap Fund": 22.99,
      "Quant ELSS Tax Saver Fund": 21.74,
      "Quant Small Cap Fund": 20.76,
      "HSBC Small Cap Fund": 20.60,
      "SBI Small Cap Fund": 20.37
      // Add more funds here
    };

    // âœ… Step 2: Populate dropdowns
    window.onload = () => {
      const fund1 = document.getElementById('fund1');
      const fund2 = document.getElementById('fund2');

      Object.entries(fundData).forEach(([name, cagr]) => {
        const opt1 = new Option(name, name);
        const opt2 = new Option(name, name);
        fund1.add(opt1);
        fund2.add(opt2);
      });

      fund1.selectedIndex = 1;
      fund2.selectedIndex = 2;
    };

    // âœ… Step 3: SIP Value Calculator
    function calculateSIPValue(monthlySIP, years, cagr) {
      const totalMonths = years * 12;
      const monthlyRate = cagr / 12 / 100;
      let value = 0;
      for (let i = 0; i < totalMonths; i++) {
        value = (value + monthlySIP) * (1 + monthlyRate);
      }
      return Math.round(value);
    }

    // âœ… Step 4: Compare Logic & Chart
    function compareFunds() {
      const sip = parseFloat(document.getElementById('sipAmount').value);
      const years = parseInt(document.getElementById('years').value);
      const fund1Name = document.getElementById('fund1').value;
      const fund2Name = document.getElementById('fund2').value;

      const cagr1 = fundData[fund1Name];
      const cagr2 = fundData[fund2Name];

      const months = years * 12;

      // Monthly value build-up for graph
      const data1 = [];
      const data2 = [];
      let val1 = 0, val2 = 0;
      const monthlyRate1 = cagr1 / 12 / 100;
      const monthlyRate2 = cagr2 / 12 / 100;

      for (let i = 0; i < months; i++) {
        val1 = (val1 + sip) * (1 + monthlyRate1);
        val2 = (val2 + sip) * (1 + monthlyRate2);
        data1.push(Math.round(val1));
        data2.push(Math.round(val2));
      }

      // Final values
      const final1 = Math.round(val1);
      const final2 = Math.round(val2);

      // Show result with real fund names
      document.getElementById('compareResult').innerHTML = `
        <p><strong>${fund1Name} Final Value:</strong> â‚¹${final1.toLocaleString()}</p>
        <p><strong>${fund2Name} Final Value:</strong> â‚¹${final2.toLocaleString()}</p>
        <p><strong>Potential Gain if Switched:</strong> â‚¹${Math.abs(final1 - final2).toLocaleString()}</p>
      `;

      // Chart rendering
      const ctx = document.getElementById('compareChart').getContext('2d');
      if (window.myChart) window.myChart.destroy();
      window.myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: Array.from({ length: months }, (_, i) => `M${i + 1}`),
          datasets: [
            {
              label: fund1Name,
              data: data1,
              borderColor: '#4f46e5',
              fill: false,
              tension: 0.2
            },
            {
              label: fund2Name,
              data: data2,
              borderColor: '#f59e0b',
              fill: false,
              tension: 0.2
            }
          ]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              ticks: {
                callback: value => 'â‚¹' + value.toLocaleString()
              }
            }
          }
        }
      });
    }
  </script>
</body>
</html>
